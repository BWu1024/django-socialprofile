{% extends "base.html" %}
{% load socialprofile_tags %}

{% block headtitle %}Profile{% endblock %}

{% block body_class %}{% endblock %}

{% block head %}{% endblock %}

{% block content %}
    <section title="profile">
        {%  if user.get_profile.image_url %}
            <img src="{{ user.get_profile.image_url }}" />
        {% endif %}
        <h1>Edit Your Profile</h1>
        {{ form.errors }}
        <form action="{%  url profile_page %}" method="post">
            {% csrf_token %}
            <ul>
                {{ form.as_ul }}
            </ul>
            <p><input type="submit" value="Save Changes"></p>
        </form>
    </section>
    <h2>Social Authentication Connections</h2>
    <ul>
        {%  with num_connections=user.social_auth.all.count %}
        {% for user_social_auth in user.social_auth.all %}
                <li>{{ user_social_auth.provider|social_provider_name }} {% if num_connections > 1 %}<a href="{% url socialauth_disconnect user_social_auth.provider %}">Disconnect</a>{% else %}<em>(Primary Connection, Can't Be Deleted)</em>{% endif %}</li>
        {% endfor %}
        {% endwith %}
        <li><a href="#" onclick="openLoginModal()">Add Social Authentication Connection</a></li>
        {% include "login_modal.html" %}
    </ul>
    <h2><a href="#" onclick="openDeleteAccountModal();">Delete Account</a></h2>
    {% include "delete_account_modal.html" %}
{% endblock %}